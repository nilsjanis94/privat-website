.scanner-container {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;

  // Erweiterte Container-Breite für große Bildschirme
  @media (min-width: 1200px) {
    max-width: 1200px;
    padding: 32px;
  }

  @media (min-width: 1600px) {
    max-width: 1400px;
    padding: 40px;
  }

  @media (min-width: 1920px) {
    max-width: 1600px;
    padding: 48px;
  }

  // Für Ultra-wide Displays
  @media (min-width: 2560px) {
    max-width: 1800px;
    padding: 60px;
  }

  .header {
    text-align: center;
    margin-bottom: 24px;

    h2 {
      margin: 0 0 8px 0;
      color: var(--primary-600);
      font-size: 1.8rem;
      font-weight: 600;
    }

    .subtitle {
      color: var(--text-secondary);
      margin: 0;
      font-size: 1rem;
    }
  }

  .scanner-tabs {
    margin-bottom: 24px;

    .tab-content {
      padding: 24px 16px;
    }

    // Tab-Labels für beide Modi
    ::ng-deep {
      .mat-mdc-tab-label {
        color: var(--text-primary);
        
        &.mdc-tab--active {
          color: var(--primary-600);
        }

        .mdc-tab__text-label {
          color: inherit;
        }
      }

      .mat-mdc-tab-header {
        border-bottom: 1px solid var(--border-primary);
      }

      .mdc-tab-indicator__content--underline {
        border-color: var(--primary-600);
      }

      // Sehr spezifischer Fix für Tab-Text-Labels
      .mdc-tab__text-label {
        color: var(--text-primary) !important;
      }

      // Fallback mit Element-Selektor
      span.mdc-tab__text-label {
        color: var(--text-primary) !important;
      }

      // Zusätzlicher Fix für aktive Tabs
      .mdc-tab--active .mdc-tab__text-label {
        color: var(--primary-600) !important;
      }
    }
  }

  .scanner-card,
  .camera-card,
  .results-card,
  .product-card,
  .help-card {
    margin-bottom: 24px;
    border-left: 4px solid var(--primary-600);
    background: var(--surface);
    color: var(--text-primary);

    mat-card-title {
      color: var(--text-primary);
    }

    mat-card-subtitle {
      color: var(--text-secondary);
    }
  }

  .scanner-card {
    .scanner-input {
      display: flex;
      flex-direction: column;
      gap: 16px;

      .barcode-field {
        width: 100%;
      }

      .scanner-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;

        button {
          display: flex;
          align-items: center;
          gap: 8px;
        }
      }
    }
  }

  .camera-card {
    border-left-color: var(--accent-600);

    .camera-error {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);

      mat-icon {
        font-size: 48px;
        width: 48px;
        height: 48px;
        color: var(--error);
        margin-bottom: 16px;
      }

      h3 {
        margin: 16px 0 8px 0;
        color: var(--text-primary);
        font-size: 1.2rem;
      }

      p {
        margin: 0;
        font-size: 0.9rem;
        line-height: 1.4;
      }
    }

    .camera-controls {
      text-align: center;
      margin-bottom: 20px;

      button {
        display: flex;
        align-items: center;
        gap: 8px;
        margin: 0 auto;
      }
    }

    .camera-view {
      position: relative;
      margin: 20px 0;

      .video-container {
        position: relative;
        background: #000;
        border-radius: 12px;
        overflow: hidden;
        aspect-ratio: 16/9;
        max-height: 400px;

        .camera-video {
          width: 100%;
          height: 100%;
          object-fit: cover;
          display: block;
        }

        .scanning-overlay {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          background: rgba(0, 0, 0, 0.3);

          .scan-frame {
            position: relative;
            width: 250px;
            height: 150px;
            margin-bottom: 20px;

            .scan-corners {
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;

              .corner {
                position: absolute;
                width: 20px;
                height: 20px;
                border: 3px solid var(--accent-600);

                &.top-left {
                  top: 0;
                  left: 0;
                  border-right: none;
                  border-bottom: none;
                }

                &.top-right {
                  top: 0;
                  right: 0;
                  border-left: none;
                  border-bottom: none;
                }

                &.bottom-left {
                  bottom: 0;
                  left: 0;
                  border-right: none;
                  border-top: none;
                }

                &.bottom-right {
                  bottom: 0;
                  right: 0;
                  border-left: none;
                  border-top: none;
                }
              }
            }

            .scan-line {
              position: absolute;
              top: 50%;
              left: 0;
              right: 0;
              height: 2px;
              background: linear-gradient(90deg, transparent, var(--accent-600), transparent);
              animation: scanLine 2s ease-in-out infinite;
            }
          }

          .scan-instruction {
            color: white;
            text-align: center;
            margin: 0;
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            font-size: 0.9rem;
          }
        }
      }

      .hidden-canvas {
        display: none;
      }
    }

    .camera-hints {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 20px;

      .hint {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: var(--surface-variant);
        border-radius: 8px;
        font-size: 0.9rem;
        color: var(--text-primary);

        mat-icon {
          color: var(--accent-600);
          font-size: 20px;
        }
      }
    }
  }

  .loading {
    text-align: center;
    padding: 20px;
    margin-bottom: 24px;
    background: var(--surface);
    color: var(--text-primary);

    mat-progress-bar {
      margin-bottom: 16px;
    }

    p {
      color: var(--text-secondary);
      margin: 0;
    }
  }

  .results-card {
    border-left-color: var(--success);

    .existing-items {
      display: grid;
      gap: 12px;

      .existing-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        background: var(--surface-variant);
        border-radius: 8px;
        transition: background-color 0.2s ease;

        &:hover {
          background: var(--gray-200);
        }

        .item-icon {
          color: var(--primary-600);
          font-size: 24px;
        }

        .item-details {
          flex: 1;

          h4 {
            margin: 0 0 4px 0;
            color: var(--text-primary);
            font-size: 1rem;
          }

          .category {
            margin: 0 0 2px 0;
            color: var(--primary-600);
            font-size: 0.9rem;
            font-weight: 500;
          }

          .location {
            margin: 0 0 4px 0;
            color: var(--text-secondary);
            font-size: 0.8rem;
          }

          .status {
            margin: 0;
            padding: 2px 8px;
            background: var(--success);
            color: white;
            border-radius: 12px;
            font-size: 0.8rem;
            display: inline-block;

            &.consumed {
              background: var(--warning);
            }
          }
        }

        .item-price {
          font-weight: 600;
          color: var(--primary-600);
          font-size: 1.1rem;
        }
      }
    }
  }

  .product-card {
    border-left-color: var(--info);

    .product-info {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 20px;
      margin-bottom: 20px;

      .product-image {
        width: 120px;
        height: 120px;
        border-radius: 8px;
        overflow: hidden;
        border: 1px solid var(--border-primary);

        img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
      }

      .product-details {
        .product-field {
          margin-bottom: 12px;

          strong {
            color: var(--text-primary);
            font-weight: 600;
          }

          .ingredients {
            margin: 4px 0 0 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
            max-height: 60px;
            overflow-y: auto;
          }

          &.source-info {
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid var(--border-primary);
            font-size: 0.9rem;
            color: var(--text-secondary);

            strong {
              color: var(--primary-600);
            }
          }
        }
      }
    }

    .product-actions {
      display: flex;
      justify-content: center;
      padding-top: 16px;
      border-top: 1px solid var(--border-primary);

      button {
        display: flex;
        align-items: center;
        gap: 8px;
      }
    }

    // Styles für "nicht gefunden" Sektion
    .not-found-content {
      text-align: center;
      padding: 20px;

      .not-found-info {
        margin-bottom: 32px;

        .large-icon {
          font-size: 48px;
          width: 48px;
          height: 48px;
          color: var(--info);
          margin-bottom: 16px;
        }

        h3 {
          margin: 0 0 16px 0;
          color: var(--text-primary);
          font-size: 1.3rem;
          font-weight: 600;
        }

        p {
          margin: 0 0 12px 0;
          color: var(--text-secondary);
          line-height: 1.6;

          &.hint {
            margin-top: 20px;
            font-weight: 500;
            color: var(--text-primary);
          }
        }

        .reasons-list {
          text-align: left;
          max-width: 400px;
          margin: 16px auto 0 auto;
          padding: 16px 20px;
          background: var(--surface-variant);
          border-radius: 8px;
          border-left: 3px solid var(--info);

          li {
            margin: 8px 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
          }
        }

        .tried-sources {
          margin: 20px 0;
          padding: 16px;
          background: var(--surface-variant);
          border-radius: 8px;
          border-left: 3px solid var(--warning);

          p {
            margin: 0 0 8px 0;
            font-weight: 500;
            color: var(--text-primary);
          }

          .sources-list {
            margin: 0;
            padding-left: 20px;
            text-align: left;

            li {
              margin: 4px 0;
              color: var(--text-secondary);
              font-size: 0.85rem;
            }
          }
        }
      }

      .manual-entry-section {
        padding: 24px;
        background: var(--surface-accent);
        border-radius: 12px;
        border: 1px solid var(--border-accent);

        h4 {
          margin: 0 0 12px 0;
          color: var(--primary-600);
          font-size: 1.2rem;
          font-weight: 600;
        }

        p {
          margin: 0 0 20px 0;
          color: var(--text-secondary);
          line-height: 1.5;
        }

        .manual-actions {
          button {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 auto;
          }
        }
      }
    }
  }

  .help-card {
    border-left-color: var(--warning);

    .help-content {
      .tip {
        display: flex;
        align-items: flex-start;
        gap: 16px;
        margin-bottom: 20px;
        padding: 16px;
        background: var(--surface-variant);
        border-radius: 8px;

        &:last-child {
          margin-bottom: 0;
        }

        mat-icon {
          color: var(--accent-600);
          font-size: 24px;
          margin-top: 4px;
        }

        h4 {
          margin: 0 0 8px 0;
          color: var(--text-primary);
          font-size: 1rem;
        }

        p {
          margin: 0;
          color: var(--text-secondary);
          font-size: 0.9rem;
          line-height: 1.4;
        }
      }
    }
  }

  // Add to Inventory Form Styles
  .add-form-card {
    border-left: 4px solid var(--success);
    margin-bottom: 24px;
    animation: slideInUp 0.3s ease-out;
    max-width: 100%;
    overflow: hidden;
    background: var(--surface) !important;

    mat-card-header {
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-primary);
      max-width: 100%;
      overflow: hidden;

      mat-card-title {
        display: flex;
        align-items: center;
        gap: 12px;
        color: var(--success);
        font-size: 1.4rem;
        font-weight: 600;

        mat-icon {
          font-size: 28px;
          width: 28px;
          height: 28px;
        }
      }

      mat-card-subtitle {
        margin-top: 8px;
        color: var(--text-secondary);
        font-size: 1rem;
      }
    }

    mat-card-content {
      padding: 24px !important;
      max-width: 100%;
      overflow-x: hidden;
      box-sizing: border-box;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
      margin-top: 0;
      width: 100%;
      max-width: 100%;

      @media (min-width: 768px) {
        grid-template-columns: 1fr 1fr;
        gap: 32px;
        align-items: start;
      }

      @media (min-width: 1200px) {
        grid-template-columns: repeat(3, 1fr);
        gap: 40px;
        align-items: start;
      }

      @media (min-width: 1400px) {
        gap: 48px;
      }

      // Extra Abstand für große Bildschirme (Vollbild)
      @media (min-width: 1600px) {
        gap: 56px;
        grid-template-columns: repeat(3, minmax(280px, 1fr));
        align-items: stretch;
      }

      // Für sehr breite Bildschirme: bleibe bei 3 Spalten aber mit mehr Platz
      @media (min-width: 1920px) {
        gap: 64px;
        grid-template-columns: repeat(3, minmax(350px, 1fr));
        max-width: none; // Nutze vollen verfügbaren Platz
      }
    }

    .form-section {
      display: flex;
      flex-direction: column;
      gap: 20px;
      min-width: 0; // Verhindert Overflow
      width: 100%;
      min-height: fit-content;

      // Extra vertikaler Abstand für große Bildschirme
      @media (min-width: 1600px) {
        gap: 28px;
      }

      h3 {
        margin: 0 0 16px 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-primary);
        padding-bottom: 8px;
        border-bottom: 2px solid var(--primary-600);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .full-width {
        width: 100%;
        min-width: 0;
        margin-bottom: 8px; // Extra Abstand für Hints
      }

      .toggle-field {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding: 16px;
        background: var(--surface-variant);
        border-radius: 8px;
        border: 1px solid var(--border-primary);
        width: 100%;

        mat-slide-toggle {
          color: var(--text-primary);
          font-weight: 500;

          .mdc-label {
            color: var(--text-primary) !important;
          }

          .mdc-form-field {
            color: var(--text-primary) !important;
          }

          .mat-internal-form-field {
            color: var(--text-primary) !important;
          }

          .mdc-switch__track {
            background: var(--gray-600);

            &::before {
              background: var(--gray-600);
            }
          }

          &.mat-checked {
            .mdc-switch__track {
              background: var(--primary-600);

              &::before {
                background: var(--primary-600);
              }
            }

            .mdc-switch__handle {
              .mdc-switch__icon {
                color: var(--primary-600);
              }
            }
          }
        }

        .toggle-description {
          margin: 0;
          font-size: 0.9rem;
          color: var(--text-secondary);
          line-height: 1.4;
        }
      }
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--border-primary);
      flex-wrap: wrap;

      @media (max-width: 768px) {
        flex-direction: column;

        button {
          width: 100%;
          justify-content: center;
        }
      }

      button {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 24px;
        border-radius: 8px;
        font-weight: 500;
        transition: all 0.2s ease;
        min-width: 120px;

        &:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        &[color="primary"] {
          background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-700) 100%);
          
          &:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
          }
        }

        &:not([color="primary"]) {
          border: 1px solid var(--border-primary);
          background: var(--surface);
          color: var(--text-primary);
          
          &:hover:not(:disabled) {
            background: var(--surface-variant);
            transform: translateY(-1px);
          }
        }
      }
    }

    // Material form field overrides
    mat-form-field {
      width: 100%;
      margin-bottom: 24px !important; // Erhöhter Abstand zwischen Feldern für Vollbildmodus
      
      &.mat-mdc-form-field {
        .mat-mdc-text-field-wrapper {
          border-radius: 8px;
          background: var(--surface);
        }

        &.mat-focused {
          .mdc-notched-outline__leading,
          .mdc-notched-outline__notch,
          .mdc-notched-outline__trailing {
            border-color: var(--primary-600) !important;
            border-width: 2px !important;
          }
        }

        .mat-mdc-form-field-error {
          color: var(--error);
          font-size: 0.85rem;
          margin-top: 6px;
          position: relative;
          z-index: 10;
        }

        .mat-mdc-form-field-hint {
          color: var(--text-secondary);
          font-size: 0.85rem;
          margin-top: 6px;
          position: relative;
          z-index: 10;
          line-height: 1.3;
          padding-bottom: 4px;
        }

        // Verbesserte Styling für hint container
        .mat-mdc-form-field-subscript-wrapper {
          position: relative;
          min-height: 28px; // Erhöhte min-height für mehr Platz
          margin-top: 6px;
          margin-bottom: 12px; // Erhöhtes margin-bottom
          padding-bottom: 8px; // Erhöhtes padding-bottom
        }

        .mdc-notched-outline__leading,
        .mdc-notched-outline__notch,
        .mdc-notched-outline__trailing {
          border-color: var(--border-primary);
        }

        &:hover .mdc-notched-outline__leading,
        &:hover .mdc-notched-outline__notch,
        &:hover .mdc-notched-outline__trailing {
          border-color: var(--primary-400);
        }

        .mdc-floating-label {
          color: var(--text-secondary);
        }

        .mat-mdc-input-element {
          color: var(--text-primary);
          background: transparent;
        }

        textarea.mat-mdc-input-element {
          color: var(--text-primary);
          background: transparent;
        }

        // Extra Abstand für Form Fields mit Hints
        &:has(.mat-mdc-form-field-hint) {
          margin-bottom: 32px !important;

          @media (min-width: 1600px) {
            margin-bottom: 40px !important;
          }
        }

        // Fallback für Browser ohne :has() Support
        &.mat-mdc-form-field:nth-child(n+2) {
          margin-top: 8px !important;
        }

        // Spezifische Regeln für bekannte Felder mit Hints
        &[ng-reflect-name="expiry_date"],
        &[ng-reflect-name="expected_lifetime_days"] {
          margin-bottom: 32px !important;

          @media (min-width: 1600px) {
            margin-bottom: 40px !important;
          }
        }
      }
    }

    // Select dropdown styling
    mat-select {
      .mat-mdc-select-trigger {
        border-radius: 8px;
        color: var(--text-primary);
      }

      .mat-mdc-select-arrow {
        color: var(--text-secondary);
      }
    }

    // Textarea styling
    textarea {
      resize: vertical;
      min-height: 80px;
      background: transparent;
    }

    // Datepicker styling
    .mat-mdc-form-field-icon-suffix {
      color: var(--primary-600);
    }

    // Datepicker Icon Styling (Light Mode)
    .mat-datepicker-toggle {
      color: var(--primary-600);

      .mat-mdc-icon-button {
        color: var(--primary-600);
      }

      .mat-datepicker-toggle-default-icon {
        color: var(--primary-600);
        fill: var(--primary-600);
      }

      &:hover {
        .mat-mdc-icon-button {
          background: rgba(124, 58, 237, 0.1);
        }
      }
    }
  }

  // Animation keyframes
  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  // Enhanced loading state for form
  .form-loading {
    position: relative;
    
    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      z-index: 10;
    }
  }
}

// Scan Line Animation
@keyframes scanLine {
  0% {
    transform: translateY(-20px);
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateY(20px);
    opacity: 0;
  }
}

// Mobile Optimierungen
@media (max-width: 768px) {
  .scanner-container {
    padding: 16px;

    .header {
      h2 {
        font-size: 1.5rem;
      }
    }

    .scanner-tabs .tab-content {
      padding: 16px 8px;
    }

    .scanner-input .scanner-actions {
      flex-direction: column;

      button {
        width: 100%;
        justify-content: center;
      }
    }

    .camera-view .video-container {
      .scanning-overlay .scan-frame {
        width: 200px;
        height: 120px;
      }
    }

    .camera-hints {
      .hint {
        flex-direction: column;
        text-align: center;
        gap: 8px;
      }
    }

    .product-info {
      grid-template-columns: 1fr !important;
      text-align: center;

      .product-image {
        justify-self: center;
      }
    }

    .existing-item {
      flex-direction: column;
      text-align: center;
      gap: 12px !important;

      .item-details {
        order: 1;
      }

      .item-price {
        order: 2;
        font-size: 1.2rem !important;
      }

      .item-icon {
        order: 0;
      }
    }

    .tip {
      flex-direction: column !important;
      text-align: center;
    }
  }
}

// === DARK MODE SUPPORT FOR ADD FORM ===
.dark-theme .scanner-container {
  .add-form-card {
    background: var(--surface) !important;
    border-left-color: var(--success);
    border: 1px solid var(--border-primary);

    mat-card-header {
      background: var(--surface);
      border-bottom-color: var(--border-primary);

      mat-card-title {
        color: var(--success);
      }

      mat-card-subtitle {
        color: var(--text-secondary);
      }
    }

    mat-card-content {
      background: var(--surface);
    }

    .form-section {
      h3 {
        color: var(--text-primary);
        border-bottom-color: var(--primary-400);
      }

      .toggle-field {
        background: var(--surface-variant);
        border-color: var(--border-primary);

        mat-slide-toggle {
          color: var(--text-primary);
          font-weight: 500;

          .mdc-label {
            color: var(--text-primary) !important;
          }

          .mdc-form-field {
            color: var(--text-primary) !important;
          }

          .mat-internal-form-field {
            color: var(--text-primary) !important;
          }

          .mdc-switch__track {
            background: var(--gray-600);

            &::before {
              background: var(--gray-600);
            }
          }

          &.mat-checked {
            .mdc-switch__track {
              background: var(--primary-600);

              &::before {
                background: var(--primary-600);
              }
            }

            .mdc-switch__handle {
              .mdc-switch__icon {
                color: var(--primary-600);
              }
            }
          }
        }

        .toggle-description {
          margin: 0;
          font-size: 0.9rem;
          color: var(--text-secondary);
          line-height: 1.4;
        }
      }
    }

    .form-actions {
      background: var(--surface);
      border-top-color: var(--border-primary);

      button {
        &[color="primary"] {
          background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-700) 100%);
          color: white;
        }

        &:not([color="primary"]) {
          border-color: var(--border-primary);
          background: var(--surface);
          color: var(--text-primary);

          &:hover:not(:disabled) {
            background: var(--surface-variant);
          }
        }
      }
    }

    // Material form field dark mode overrides
    mat-form-field {
      &.mat-mdc-form-field {
        .mat-mdc-text-field-wrapper {
          background: var(--surface-form-field) !important;
        }

        .mdc-notched-outline__leading,
        .mdc-notched-outline__notch,
        .mdc-notched-outline__trailing {
          border-color: var(--border-primary) !important;
        }

        &:hover .mdc-notched-outline__leading,
        &:hover .mdc-notched-outline__notch,
        &:hover .mdc-notched-outline__trailing {
          border-color: var(--primary-400) !important;
        }

        &.mat-focused .mdc-notched-outline__leading,
        &.mat-focused .mdc-notched-outline__notch,
        &.mat-focused .mdc-notched-outline__trailing {
          border-color: var(--primary-400) !important;
          border-width: 2px !important;
        }

        .mdc-floating-label {
          color: var(--text-secondary) !important;

          &.mdc-floating-label--float-above {
            color: var(--primary-400) !important;
          }
        }

        .mat-mdc-input-element {
          color: var(--text-primary) !important;
          caret-color: var(--primary-400) !important;
          background: var(--surface-form-field) !important;

          &::placeholder {
            color: var(--text-muted) !important;
          }
        }

        textarea.mat-mdc-input-element {
          color: var(--text-primary) !important;
          background: var(--surface-form-field) !important;
        }

        .mat-mdc-form-field-error {
          color: var(--error) !important;
          margin-top: 6px !important;
        }

        .mat-mdc-form-field-hint {
          color: var(--text-secondary) !important;
          margin-top: 6px !important;
          padding-bottom: 4px !important;
        }

        .mat-mdc-form-field-subscript-wrapper {
          color: var(--text-secondary) !important;
          background: transparent !important;
          min-height: 28px !important;
          margin-top: 6px !important;
          margin-bottom: 12px !important;
          padding-bottom: 8px !important;
        }

        .mat-mdc-form-field-icon-suffix {
          color: var(--primary-400) !important;
        }

        .mat-mdc-form-field-text-prefix {
          color: var(--text-secondary) !important;
        }

        // Error state styling
        &.mat-form-field-invalid {
          .mdc-notched-outline__leading,
          .mdc-notched-outline__notch,
          .mdc-notched-outline__trailing {
            border-color: var(--error) !important;
          }

          .mdc-floating-label {
            color: var(--error) !important;
          }
        }
      }
    }

    // Select dropdown dark mode
    mat-select {
      color: var(--text-primary) !important;

      .mat-mdc-select-trigger {
        color: var(--text-primary) !important;
        background: var(--surface-form-field) !important;

        .mat-mdc-select-value {
          color: var(--text-primary) !important;
        }

        .mat-mdc-select-value-text {
          color: var(--text-primary) !important;
        }
      }

      .mat-mdc-select-arrow {
        color: var(--text-secondary) !important;
      }

      &.mat-focused {
        .mat-mdc-select-arrow {
          color: var(--primary-400) !important;
        }
      }

      .mat-mdc-select-placeholder {
        color: var(--text-muted) !important;
      }

      // Explizite Styles für ausgewählten Text
      .mdc-select__selected-text {
        color: var(--text-primary) !important;
      }
    }

    // Datepicker dark mode
    .mat-datepicker-toggle {
      color: var(--primary-400) !important;

      .mat-mdc-icon-button {
        color: var(--primary-400) !important;
      }

      .mat-datepicker-toggle-default-icon {
        color: var(--primary-400) !important;
        fill: var(--primary-400) !important;
      }

      &:hover {
        .mat-mdc-icon-button {
          background: rgba(124, 90, 192, 0.1) !important;
        }
      }
    }

    .mat-mdc-form-field-subscript-wrapper {
      color: var(--text-secondary) !important;
    }
  }

  // Form loading overlay dark mode
  .form-loading {
    &::after {
      background: rgba(26, 26, 58, 0.8);
    }
  }
}

// === GLOBAL DARK MODE OVERRIDES FOR MATERIAL COMPONENTS ===
.dark-theme {
  // Select panel dark mode
  .cdk-overlay-container {
    .mat-mdc-select-panel {
      background: var(--surface) !important;
      border: 1px solid var(--border-primary) !important;

      .mat-mdc-option {
        color: var(--text-primary) !important;

        &:hover:not(.mdc-list-item--disabled) {
          background: var(--surface-variant) !important;
        }

        &.mdc-list-item--selected {
          background: var(--primary-900) !important;
          color: var(--primary-300) !important;
        }

        &.mat-mdc-option-active {
          background: var(--surface-variant) !important;
        }
      }
    }

    // Datepicker dark mode
    .mat-datepicker-popup {
      background: var(--surface) !important;
      border: 1px solid var(--border-primary) !important;
      box-shadow: var(--shadow-xl) !important;

      .mat-calendar {
        background: var(--surface) !important;
        color: var(--text-primary) !important;

        .mat-calendar-header {
          background: var(--surface-variant) !important;
          color: var(--text-primary) !important;

          .mat-calendar-arrow {
            border-top-color: var(--text-primary) !important;
          }

          .mat-calendar-controls {
            .mat-mdc-button {
              color: var(--text-primary) !important;
            }
          }
        }

        .mat-calendar-content {
          background: var(--surface) !important;

          .mat-calendar-table {
            .mat-calendar-body-cell {
              color: var(--text-primary) !important;

              &:hover {
                background: var(--surface-variant) !important;
              }

              &.mat-calendar-body-active {
                background: var(--primary-600) !important;
                color: white !important;
              }

              &.mat-calendar-body-selected {
                background: var(--primary-600) !important;
                color: white !important;
              }

              &.mat-calendar-body-comparison-identical {
                background: var(--primary-800) !important;
              }

              &.mat-calendar-body-today {
                border-color: var(--primary-400) !important;
              }

              &.mat-calendar-body-disabled {
                color: var(--text-muted) !important;
              }
            }

            .mat-calendar-body-label {
              color: var(--text-secondary) !important;
              font-weight: 500 !important;
            }
          }
        }

        .mat-calendar-period-button {
          color: var(--text-primary) !important;
        }

        .mat-calendar-next-button,
        .mat-calendar-previous-button {
          color: var(--text-primary) !important;
        }
      }
    }
  }

  // Material form validation states
  .mat-mdc-form-field {
    &.mat-form-field-invalid {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--error) !important;
      }

      .mdc-floating-label {
        color: var(--error) !important;
      }
    }
  }

  // Snackbar overrides for success/error states
  .success-snackbar {
    background: var(--success) !important;
    color: white !important;
  }

  .error-snackbar {
    background: var(--error) !important;
    color: white !important;
  }
}

// Explizite Dark Mode Tab-Styles für bessere Kompatibilität
:host-context(.dark-theme) .scanner-container {
  .scanner-tabs {
    ::ng-deep {
      .mat-mdc-tab-label {
        color: var(--text-primary) !important;
        
        &.mdc-tab--active {
          color: var(--primary-600) !important;
        }

        .mdc-tab__text-label {
          color: inherit !important;
        }
      }

      .mat-mdc-tab-header {
        border-bottom-color: var(--border-primary) !important;
      }

      .mdc-tab-indicator__content--underline {
        border-color: var(--primary-600) !important;
      }
    }
  }
}

// Fallback für Browser ohne :host-context Support
.dark-theme .scanner-container {
  .scanner-tabs {
    ::ng-deep {
      .mat-mdc-tab-label {
        color: var(--text-primary) !important;
        
        &.mdc-tab--active {
          color: var(--primary-600) !important;
        }

        .mdc-tab__text-label {
          color: inherit !important;
        }
      }

      .mat-mdc-tab-header {
        border-bottom-color: var(--border-primary) !important;
      }

      .mdc-tab-indicator__content--underline {
        border-color: var(--primary-600) !important;
      }
    }
  }
}

// Material Components Style Overrides
.scanner-container {
  mat-form-field {
    &.mat-mdc-form-field {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--border-primary);
      }

      &:hover .mdc-notched-outline__leading,
      &:hover .mdc-notched-outline__notch,
      &:hover .mdc-notched-outline__trailing {
        border-color: var(--primary-600);
      }

      &.mat-focused .mdc-notched-outline__leading,
      &.mat-focused .mdc-notched-outline__notch,
      &.mat-focused .mdc-notched-outline__trailing {
        border-color: var(--primary-600);
      }

      .mdc-floating-label {
        color: var(--text-secondary);
      }

      .mat-mdc-input-element {
        color: var(--text-primary);
      }
    }
  }

  mat-hint {
    color: var(--text-secondary);
  }

  // Tab Styles
  ::ng-deep {
    .mat-mdc-tab-label {
      color: var(--text-primary);
      
      &.mdc-tab--active {
        color: var(--primary-600);
      }

      .mdc-tab__text-label {
        color: inherit;
      }
    }

    .mat-mdc-tab-header {
      border-bottom: 1px solid var(--border-primary);
    }

    .mdc-tab-indicator__content--underline {
      border-color: var(--primary-600);
    }
  }

  h1, h2, h3, h4, h5, h6 {
    color: var(--text-primary);
  }

  p, span, div {
    color: var(--text-primary);
  }

  .subtitle {
    color: var(--text-secondary);
  }
}

// Sehr spezifische Dark Mode Regel für die mat-card
.dark-theme mat-card.add-form-card,
.dark-theme .mat-mdc-card.add-form-card {
  background: var(--surface) !important;
  background-color: var(--surface) !important;
  color: var(--text-primary) !important;
  border: 1px solid var(--border-primary) !important;
  
  .mat-mdc-card-header {
    background: var(--surface) !important;
    background-color: var(--surface) !important;
  }

  .mat-mdc-card-content {
    background: var(--surface) !important;
    background-color: var(--surface) !important;
  }
}

// Nochmals spezifischer für Angular Material
:host-context(.dark-theme) mat-card.add-form-card,
:host-context(.dark-theme) .mat-mdc-card.add-form-card {
  background: var(--surface) !important;
  background-color: var(--surface) !important;
  color: var(--text-primary) !important;
}

// Allgemeine mat-card Dark Mode Regel
.dark-theme .mat-mdc-card {
  background: var(--surface) !important;
  background-color: var(--surface) !important;
  color: var(--text-primary) !important;
}

// Datepicker Dark Mode Fixes
.cdk-overlay-container .mat-datepicker-popup {
  .mat-calendar {
    .mat-calendar-body-cell {
      color: var(--text-primary) !important;

      .mat-calendar-body-cell-content {
        color: var(--text-primary) !important;
      }
    }

    .mat-calendar-table-header th {
      color: var(--text-secondary) !important;
    }

    .mat-calendar-period-button {
      color: var(--text-primary) !important;
    }

    .mat-calendar-next-button,
    .mat-calendar-previous-button {
      color: var(--text-primary) !important;
    }
  }
}

